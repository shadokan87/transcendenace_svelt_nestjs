// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  school_id   	Int @id
  unique_name 	String @unique
  username    	String
  displayName 	String
  first_name  	String
  last_name   	String
  profileUrl  	String
  email       	String
  photo       	String
  //channel
  subscribedChannel Channel[] @relation(name: "subscribe")
  ownerInChannel	Channel[] @relation
  adminInChannel	Channel[] @relation(name: "admin")
  //friends
  friends     	Int[]
  pendingFriends	Int[]
  bans			Int[]
  //profile
  Stats       	Stats?
  match_history Game[]
  status      	String
  nickname		String @unique @default("")
  useIntraPhoto Boolean @default(true)
  avatar String @default("user-default")
  createdAt DateTime @default(now())
  updateAt  DateTime @updatedAt 
  // @@map("users")
}

model Stats {
  UserId  Int @unique
  owner   User @relation(fields: [UserId], references: [school_id])

  wins    Int
  losses  Int
  ladder_level  Int
  // achievements  String?
}

model Game {
  id              Int @id @default(autoincrement())
  UserId          Int
  owner           User @relation(fields: [UserId], references: [school_id])
  tag             String
  winner          Int
  looser          Int
  winners_points  Int
  loosers_points  Int
}

model Channel {
	id Int @id @unique @default(autoincrement())
	name	String
	avatar	String	@default("default-channel")
	password String @default("")
	visibility Boolean
  	UserId          Int
  	owner           User @relation(fields: [UserId], references: [school_id])
	Posts		Post[]
	subscribedUsers User[] @relation(name: "subscribe")
	bannedUsers		Int[]
	admins			User[] @relation(name: "admin")
}

model Post {
	id Int @id @unique @default(autoincrement())
	message String
	chanId Int
	chan		Channel @relation(fields: [chanId], references: [id])
}
